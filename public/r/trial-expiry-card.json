{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "trial-expiry-card",
  "type": "registry:block",
  "title": "Trial Expiry Card",
  "description": "A card component that displays trial expiration countdown with progress indicator and feature list",
  "dependencies": [
    "lucide-react",
    "motion"
  ],
  "registryDependencies": [
    "button",
    "card",
    "badge",
    "utils"
  ],
  "files": [
    {
      "path": "src/registry/billingsdk/trial-expiry-card.tsx",
      "content": "\"use client\";\r\n\r\nimport { useState, useEffect } from \"react\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport {\r\n  Card,\r\n  CardContent,\r\n  CardDescription,\r\n  CardHeader,\r\n  CardTitle,\r\n} from \"@/components/ui/card\";\r\nimport { cn } from \"@/lib/utils\";\r\nimport { Check } from \"lucide-react\";\r\n\r\nexport interface TrialExpiryCardProps {\r\n  trialEndDate?: Date | string | number;\r\n  daysRemaining?: number;\r\n  onUpgrade?: () => void | Promise<void>;\r\n  className?: string;\r\n  title?: string;\r\n  description?: string;\r\n  upgradeButtonText?: string;\r\n  features?: string[];\r\n}\r\n\r\ninterface TimeRemaining {\r\n  days: number;\r\n  hours: number;\r\n  minutes: number;\r\n  seconds: number;\r\n}\r\n\r\nconst calculateTimeRemaining = (\r\n  endDate: Date | string | number,\r\n): TimeRemaining => {\r\n  try {\r\n    let end: Date;\r\n    if (typeof endDate === \"string\") {\r\n      end = new Date(endDate);\r\n    } else if (typeof endDate === \"number\") {\r\n      end = new Date(endDate);\r\n    } else if (endDate instanceof Date) {\r\n      end = endDate;\r\n    } else {\r\n      // Fallback for any other type\r\n      return { days: 0, hours: 0, minutes: 0, seconds: 0 };\r\n    }\r\n\r\n    // Validate that we have a valid date\r\n    if (isNaN(end.getTime())) {\r\n      return { days: 0, hours: 0, minutes: 0, seconds: 0 };\r\n    }\r\n\r\n    const now = new Date();\r\n    const diff = end.getTime() - now.getTime();\r\n\r\n    if (diff <= 0) {\r\n      return { days: 0, hours: 0, minutes: 0, seconds: 0 };\r\n    }\r\n\r\n    return {\r\n      days: Math.floor(diff / (1000 * 60 * 60 * 24)),\r\n      hours: Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60)),\r\n      minutes: Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60)),\r\n      seconds: Math.floor((diff % (1000 * 60)) / 1000),\r\n    };\r\n  } catch (error) {\r\n    console.error(\"Error calculating time remaining:\", error);\r\n    return { days: 0, hours: 0, minutes: 0, seconds: 0 };\r\n  }\r\n};\r\n\r\nexport function TrialExpiryCard({\r\n  trialEndDate,\r\n  daysRemaining: propDaysRemaining,\r\n  onUpgrade,\r\n  className,\r\n  title = \"Trial Period\",\r\n  description,\r\n  upgradeButtonText = \"Upgrade Now\",\r\n  features = [\r\n    \"Unlimited projects\",\r\n    \"Priority support\",\r\n    \"Advanced analytics\",\r\n    \"Custom integrations\",\r\n  ],\r\n}: TrialExpiryCardProps) {\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [timeRemaining, setTimeRemaining] = useState<TimeRemaining>(() => {\r\n    if (trialEndDate) {\r\n      return calculateTimeRemaining(trialEndDate);\r\n    }\r\n    return { days: propDaysRemaining || 0, hours: 0, minutes: 0, seconds: 0 };\r\n  });\r\n\r\n  useEffect(() => {\r\n    if (!trialEndDate) return;\r\n\r\n    const interval = setInterval(() => {\r\n      setTimeRemaining(calculateTimeRemaining(trialEndDate));\r\n    }, 1000);\r\n\r\n    return () => clearInterval(interval);\r\n  }, [trialEndDate]);\r\n\r\n  const daysRemaining = propDaysRemaining ?? timeRemaining.days;\r\n\r\n  const handleUpgrade = async () => {\r\n    if (onUpgrade) {\r\n      setIsLoading(true);\r\n      try {\r\n        await onUpgrade();\r\n      } finally {\r\n        setIsLoading(false);\r\n      }\r\n    }\r\n  };\r\n\r\n  const getStatusBadge = () => {\r\n    if (daysRemaining <= 0) return <Badge variant=\"destructive\">Expired</Badge>;\r\n    if (daysRemaining <= 2)\r\n      return <Badge variant=\"destructive\">Expiring Soon</Badge>;\r\n    if (daysRemaining <= 6) return <Badge variant=\"secondary\">Active</Badge>;\r\n    return <Badge variant=\"default\">Active</Badge>;\r\n  };\r\n\r\n  return (\r\n    <Card className={cn(\"w-full max-w-md\", className)}>\r\n      <CardHeader>\r\n        <div className=\"flex items-center justify-between\">\r\n          <CardTitle className=\"text-base font-medium\">{title}</CardTitle>\r\n          {getStatusBadge()}\r\n        </div>\r\n        {description && <CardDescription>{description}</CardDescription>}\r\n      </CardHeader>\r\n      <CardContent className=\"space-y-6\">\r\n        {/* Countdown Timer */}\r\n        {trialEndDate && daysRemaining > 0 && (\r\n          <div\r\n            className=\"bg-muted/30 rounded-lg border p-4\"\r\n            role=\"status\"\r\n            aria-live=\"polite\"\r\n            aria-atomic=\"true\"\r\n            aria-label={`Trial time remaining: ${timeRemaining.days} days, ${timeRemaining.hours} hours, ${timeRemaining.minutes} minutes, ${timeRemaining.seconds} seconds`}\r\n          >\r\n            <div className=\"flex items-center justify-center gap-2 sm:gap-4\">\r\n              <TimeUnit value={timeRemaining.days} label=\"Days\" />\r\n              <span className=\"text-muted-foreground\">:</span>\r\n              <TimeUnit value={timeRemaining.hours} label=\"Hours\" />\r\n              <span className=\"text-muted-foreground\">:</span>\r\n              <TimeUnit value={timeRemaining.minutes} label=\"Min\" />\r\n              <span className=\"text-muted-foreground\">:</span>\r\n              <TimeUnit value={timeRemaining.seconds} label=\"Sec\" />\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Features */}\r\n        <div className=\"space-y-3\">\r\n          <h3 className=\"text-sm font-semibold\">Included with upgrade</h3>\r\n          <div className=\"space-y-2\">\r\n            {features.slice(0, 4).map((feature, index) => (\r\n              <div\r\n                key={index}\r\n                className=\"text-muted-foreground flex items-center gap-2 text-sm\"\r\n              >\r\n                <Check className=\"text-primary h-4 w-4\" />\r\n                <span>{feature}</span>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n\r\n        {/* CTA Button */}\r\n        {onUpgrade && (\r\n          <Button\r\n            onClick={handleUpgrade}\r\n            disabled={isLoading}\r\n            className=\"w-full\"\r\n            size=\"lg\"\r\n          >\r\n            {isLoading ? \"Processing...\" : upgradeButtonText}\r\n          </Button>\r\n        )}\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n}\r\n\r\nfunction TimeUnit({ value, label }: { value: number; label: string }) {\r\n  return (\r\n    <div className=\"flex flex-col items-center\">\r\n      <div className=\"text-2xl font-bold tabular-nums sm:text-3xl\">\r\n        {String(value).padStart(2, \"0\")}\r\n      </div>\r\n      <div className=\"text-muted-foreground text-xs\">{label}</div>\r\n    </div>\r\n  );\r\n}\r\n",
      "type": "registry:component",
      "target": "components/billingsdk/trial-expiry-card.tsx"
    },
    {
      "path": "src/registry/billingsdk/demo/trial-expiry-card-demo.tsx",
      "content": "\"use client\";\r\n\r\nimport { TrialExpiryCard } from \"@/components/billingsdk/trial-expiry-card\";\r\n\r\nexport default function TrialExpiryCardDemo() {\r\n  // Set trial to expire in 5 days\r\n  const trialEndDate = new Date();\r\n  trialEndDate.setDate(trialEndDate.getDate() + 5);\r\n\r\n  return (\r\n    <div className=\"bg-background flex h-full min-h-[500px] w-full items-center justify-center rounded-lg border-2 p-6\">\r\n      <TrialExpiryCard\r\n        trialEndDate={trialEndDate}\r\n        onUpgrade={() => {\r\n          console.log(\"Upgrade clicked\");\r\n        }}\r\n        features={[\r\n          \"Unlimited API requests\",\r\n          \"Advanced analytics dashboard\",\r\n          \"Priority email support\",\r\n          \"Custom domain integration\",\r\n        ]}\r\n        className=\"w-full max-w-md\"\r\n      />\r\n    </div>\r\n  );\r\n}\r\n",
      "type": "registry:component",
      "target": "components/trial-expiry-card-demo.tsx"
    }
  ]
}