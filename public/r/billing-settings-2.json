{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "billing-settings-2",
  "type": "registry:block",
  "title": "Billing Settings 2",
  "description": "A comprehensive billing settings component with tabs for general, payment methods, invoices, and usage limits",
  "dependencies": [
    "currency-codes"
  ],
  "registryDependencies": [
    "button",
    "card",
    "input",
    "label",
    "select",
    "switch",
    "utils"
  ],
  "files": [
    {
      "path": "src/registry/billingsdk/billing-settings-2.tsx",
      "content": "\"use client\";\r\n\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport {\r\n  Select,\r\n  SelectContent,\r\n  SelectItem,\r\n  SelectTrigger,\r\n  SelectValue,\r\n} from \"@/components/ui/select\";\r\nimport { Switch } from \"@/components/ui/switch\";\r\nimport { cn } from \"@/lib/utils\";\r\nimport { useState, useMemo } from \"react\";\r\nimport currencyCodes from \"currency-codes\";\r\n\r\n// Define types for our props\r\nexport interface FeatureToggle {\r\n  id: string;\r\n  label: string;\r\n  description: string;\r\n  enabled: boolean;\r\n  onToggle: (enabled: boolean) => void;\r\n}\r\n\r\nexport interface InputField {\r\n  id: string;\r\n  name: string;\r\n  value?: string;\r\n  defaultValue?: string;\r\n  placeholder: string;\r\n  onChange: (value: string) => void;\r\n  label: string;\r\n  helperText?: string;\r\n  type?: \"text\" | \"email\" | \"tel\" | \"url\" | \"number\";\r\n  required?: boolean;\r\n  validation?: {\r\n    minLength?: number;\r\n    maxLength?: number;\r\n    pattern?: RegExp;\r\n    customValidator?: (value: string) => string | null;\r\n  };\r\n}\r\n\r\nexport interface ValidationError {\r\n  field: string;\r\n  message: string;\r\n}\r\n\r\nexport interface BillingSettings2Props {\r\n  className?: string;\r\n  title?: string;\r\n  features?: FeatureToggle[];\r\n  inputFields?: InputField[];\r\n  onSave?: () => void;\r\n  onCancel?: () => void;\r\n  saveButtonText?: string;\r\n  cancelButtonText?: string;\r\n  currencies?: string[]; // Array of currency codes to show (e.g., ['USD', 'EUR', 'GBP'])\r\n  currencyOptions?: { value: string; label: string }[]; // Override for custom currency options\r\n  defaultCurrency?: string;\r\n  onCurrencyChange?: (value: string) => void;\r\n  enableValidation?: boolean;\r\n  currencyRequired?: boolean;\r\n}\r\n\r\n// Validation helper functions\r\nconst validateEmail = (email: string): string | null => {\r\n  const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\r\n  if (!emailRegex.test(email)) {\r\n    return \"Please enter a valid email address\";\r\n  }\r\n  return null;\r\n};\r\n\r\nconst validateField = (value: string, field: InputField): string | null => {\r\n  // Check required validation\r\n  if (field.required && !value.trim()) {\r\n    return `${field.label} is required`;\r\n  }\r\n\r\n  // Skip other validations if field is empty and not required\r\n  if (!value.trim() && !field.required) {\r\n    return null;\r\n  }\r\n\r\n  // Check email validation\r\n  if (field.type === \"email\") {\r\n    return validateEmail(value);\r\n  }\r\n\r\n  // Check custom validation\r\n  if (field.validation?.customValidator) {\r\n    return field.validation.customValidator(value);\r\n  }\r\n\r\n  // Check pattern validation\r\n  if (field.validation?.pattern && !field.validation.pattern.test(value)) {\r\n    return `Invalid ${field.label.toLowerCase()} format`;\r\n  }\r\n\r\n  // Check length validations\r\n  if (\r\n    field.validation?.minLength &&\r\n    value.length < field.validation.minLength\r\n  ) {\r\n    return `${field.label} must be at least ${field.validation.minLength} characters`;\r\n  }\r\n\r\n  if (\r\n    field.validation?.maxLength &&\r\n    value.length > field.validation.maxLength\r\n  ) {\r\n    return `${field.label} must be no more than ${field.validation.maxLength} characters`;\r\n  }\r\n\r\n  return null;\r\n};\r\n\r\nexport function BillingSettings2({\r\n  className,\r\n  title = \"Billing Settings\",\r\n  features = [\r\n    {\r\n      id: \"auto-renewal\",\r\n      label: \"Auto-Renewal\",\r\n      description: \"Automatically renew your subscription\",\r\n      enabled: true,\r\n      onToggle: () => {},\r\n    },\r\n    {\r\n      id: \"invoice-emails\",\r\n      label: \"Invoice Emails\",\r\n      description: \"Receive emails when invoices are generated\",\r\n      enabled: true,\r\n      onToggle: () => {},\r\n    },\r\n    {\r\n      id: \"promotional-emails\",\r\n      label: \"Promotional Emails\",\r\n      description: \"Receive occasional updates about new features and offers\",\r\n      enabled: true,\r\n      onToggle: () => {},\r\n    },\r\n  ],\r\n  inputFields = [\r\n    {\r\n      id: \"fullName\",\r\n      name: \"fullName\",\r\n      defaultValue: \"\",\r\n      placeholder: \"John Doe\",\r\n      onChange: () => {},\r\n      label: \"Full Name\",\r\n      type: \"text\",\r\n      required: true,\r\n    },\r\n    {\r\n      id: \"billingEmail\",\r\n      name: \"billingEmail\",\r\n      defaultValue: \"\",\r\n      placeholder: \"user@example.com\",\r\n      onChange: () => {},\r\n      label: \"Billing Email\",\r\n      helperText: \"Invoices will be sent to this email address\",\r\n      type: \"email\",\r\n      required: true,\r\n    },\r\n    {\r\n      id: \"taxId\",\r\n      name: \"taxId\",\r\n      defaultValue: \"\",\r\n      placeholder: \"EU123456789\",\r\n      onChange: () => {},\r\n      label: \"Tax ID (Optional)\",\r\n      helperText: \"For VAT or other tax purposes\",\r\n      type: \"text\",\r\n    },\r\n  ],\r\n  onSave = () => {},\r\n  onCancel = () => {},\r\n  saveButtonText = \"Save Changes\",\r\n  cancelButtonText = \"Cancel\",\r\n  currencies, // Array of specific currency codes to show\r\n  currencyOptions, // Custom currency options override\r\n  defaultCurrency = \"USD\",\r\n  onCurrencyChange = () => {},\r\n  enableValidation = true,\r\n  currencyRequired = true,\r\n}: BillingSettings2Props) {\r\n  const [validationErrors, setValidationErrors] = useState<ValidationError[]>(\r\n    [],\r\n  );\r\n  const [currencyError, setCurrencyError] = useState<string | null>(null);\r\n\r\n  // Generate currency options from currency-codes package\r\n  const generatedCurrencyOptions = useMemo(() => {\r\n    // If custom currencyOptions are provided, use them\r\n    if (currencyOptions) {\r\n      return currencyOptions;\r\n    }\r\n\r\n    // Get all currency data\r\n    const allCurrencies = currencyCodes.data;\r\n\r\n    // If specific currencies are requested, filter to those\r\n    if (currencies && currencies.length > 0) {\r\n      return currencies\r\n        .map((code) => {\r\n          const currency = allCurrencies.find(\r\n            (c) => c.code === code.toUpperCase(),\r\n          );\r\n          return currency\r\n            ? {\r\n                value: currency.code.toLowerCase(),\r\n                label: `${currency.code} - ${currency.currency}`,\r\n              }\r\n            : null;\r\n        })\r\n        .filter(Boolean) as { value: string; label: string }[];\r\n    }\r\n\r\n    // Return all currencies if no specific ones requested\r\n    return allCurrencies\r\n      .filter((currency) => currency.code && currency.currency) // Filter out invalid entries\r\n      .map((currency) => ({\r\n        value: currency.code.toLowerCase(),\r\n        label: `${currency.code} - ${currency.currency}`,\r\n      }))\r\n      .sort((a, b) => a.label.localeCompare(b.label)); // Sort alphabetically\r\n  }, [currencies, currencyOptions]);\r\n\r\n  // Normalize the defaultCurrency to lowercase to match generated options\r\n  const normalizedDefaultCurrency = defaultCurrency?.toLowerCase();\r\n\r\n  // Validate all fields\r\n  const validateAllFields = (): boolean => {\r\n    if (!enableValidation) return true;\r\n\r\n    const errors: ValidationError[] = [];\r\n    let hasCurrencyError = false;\r\n\r\n    // Validate input fields\r\n    inputFields.forEach((field) => {\r\n      const value =\r\n        field.value !== undefined ? field.value : field.defaultValue || \"\";\r\n      const error = validateField(value, field);\r\n      if (error) {\r\n        errors.push({ field: field.id, message: error });\r\n      }\r\n    });\r\n\r\n    // Validate currency if required\r\n    if (currencyRequired && !normalizedDefaultCurrency) {\r\n      setCurrencyError(\"Please select a currency\");\r\n      hasCurrencyError = true;\r\n    } else {\r\n      setCurrencyError(null);\r\n    }\r\n\r\n    setValidationErrors(errors);\r\n    return errors.length === 0 && !hasCurrencyError;\r\n  };\r\n\r\n  // Handle save with validation\r\n  const handleSave = () => {\r\n    if (validateAllFields()) {\r\n      onSave();\r\n    }\r\n  };\r\n\r\n  // Get error for a specific field\r\n  const getFieldError = (fieldId: string): string | undefined => {\r\n    return validationErrors.find((error) => error.field === fieldId)?.message;\r\n  };\r\n\r\n  // Clear validation error for a specific field\r\n  const clearFieldError = (fieldId: string) => {\r\n    setValidationErrors((prev) =>\r\n      prev.filter((error) => error.field !== fieldId),\r\n    );\r\n  };\r\n\r\n  // Clear currency error\r\n  const clearCurrencyError = () => {\r\n    setCurrencyError(null);\r\n  };\r\n\r\n  // Enhanced input change handler that clears validation errors\r\n  const handleInputChange = (\r\n    fieldId: string,\r\n    value: string,\r\n    originalOnChange: (value: string) => void,\r\n  ) => {\r\n    // Clear the validation error for this field when user starts typing\r\n    clearFieldError(fieldId);\r\n    // Call the original onChange handler\r\n    originalOnChange(value);\r\n  };\r\n\r\n  // Enhanced currency change handler\r\n  const handleCurrencyChange = (\r\n    value: string,\r\n    originalOnChange: (value: string) => void,\r\n  ) => {\r\n    // Clear currency error when user makes a selection\r\n    clearCurrencyError();\r\n    // Call the original onChange handler\r\n    originalOnChange(value);\r\n  };\r\n  return (\r\n    <Card className={cn(\"mx-auto max-w-2xl\", className)}>\r\n      <CardHeader>\r\n        <CardTitle className=\"text-lg\">{title}</CardTitle>\r\n      </CardHeader>\r\n      <CardContent className=\"space-y-6\">\r\n        <p className=\"text-muted-foreground text-sm\">\r\n          Manage your billing preferences and settings\r\n        </p>\r\n\r\n        <div className=\"grid grid-cols-1 gap-6 md:grid-cols-2\">\r\n          {inputFields.map((field) => {\r\n            const error = getFieldError(field.id);\r\n            return (\r\n              <div key={field.id} className=\"space-y-2\">\r\n                <Label htmlFor={field.id}>\r\n                  {field.label}\r\n                  {field.required && (\r\n                    <span className=\"ml-1 text-red-500\">*</span>\r\n                  )}\r\n                </Label>\r\n                <Input\r\n                  id={field.id}\r\n                  name={field.name}\r\n                  {...(field.value !== undefined\r\n                    ? { value: field.value }\r\n                    : { defaultValue: field.defaultValue })}\r\n                  placeholder={field.placeholder}\r\n                  onChange={(e) =>\r\n                    handleInputChange(field.id, e.target.value, field.onChange)\r\n                  }\r\n                  type={field.type || \"text\"}\r\n                  aria-describedby={\r\n                    field.helperText ? `${field.id}-help` : undefined\r\n                  }\r\n                  className={error ? \"border-red-500 focus:border-red-500\" : \"\"}\r\n                />\r\n                {error ? (\r\n                  <p className=\"text-xs text-red-500\">{error}</p>\r\n                ) : field.helperText ? (\r\n                  <p\r\n                    id={`${field.id}-help`}\r\n                    className=\"text-muted-foreground text-xs\"\r\n                  >\r\n                    {field.helperText}\r\n                  </p>\r\n                ) : null}\r\n              </div>\r\n            );\r\n          })}\r\n\r\n          <div className=\"min-w-0 space-y-2\">\r\n            <Label id=\"currency-label\">\r\n              Currency\r\n              {currencyRequired && <span className=\"ml-1 text-red-500\">*</span>}\r\n            </Label>\r\n            <Select\r\n              value={normalizedDefaultCurrency}\r\n              onValueChange={(value) =>\r\n                handleCurrencyChange(value, onCurrencyChange)\r\n              }\r\n            >\r\n              <SelectTrigger\r\n                aria-labelledby=\"currency-label\"\r\n                className={cn(\r\n                  \"w-[280px] flex-shrink-0\",\r\n                  currencyError ? \"border-red-500 focus:border-red-500\" : \"\",\r\n                )}\r\n              >\r\n                <SelectValue\r\n                  placeholder=\"Select currency\"\r\n                  className=\"truncate overflow-hidden text-ellipsis whitespace-nowrap\"\r\n                />\r\n              </SelectTrigger>\r\n              <SelectContent className=\"max-h-[200px] w-[280px]\">\r\n                {generatedCurrencyOptions.map((option) => (\r\n                  <SelectItem\r\n                    key={option.value}\r\n                    value={option.value}\r\n                    className=\"w-full\"\r\n                  >\r\n                    <span\r\n                      className=\"block w-full truncate\"\r\n                      title={option.label}\r\n                    >\r\n                      {option.label}\r\n                    </span>\r\n                  </SelectItem>\r\n                ))}\r\n              </SelectContent>\r\n            </Select>\r\n            {currencyError && (\r\n              <p className=\"text-xs text-red-500\">{currencyError}</p>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"space-y-4\">\r\n          {features.map((feature) => (\r\n            <div\r\n              key={feature.id}\r\n              className=\"flex items-center justify-between rounded-lg border p-4\"\r\n            >\r\n              <div>\r\n                <div className=\"font-medium\">{feature.label}</div>\r\n                <div className=\"text-muted-foreground text-sm\">\r\n                  {feature.description}\r\n                </div>\r\n              </div>\r\n              <Switch\r\n                aria-label={feature.label}\r\n                checked={feature.enabled}\r\n                onCheckedChange={feature.onToggle}\r\n              />\r\n            </div>\r\n          ))}\r\n        </div>\r\n\r\n        <div className=\"flex items-center justify-end gap-3 pt-2\">\r\n          <Button variant=\"outline\" onClick={onCancel}>\r\n            {cancelButtonText}\r\n          </Button>\r\n          <Button\r\n            onClick={handleSave}\r\n            disabled={\r\n              enableValidation &&\r\n              (validationErrors.length > 0 || !!currencyError)\r\n            }\r\n          >\r\n            {saveButtonText}\r\n          </Button>\r\n        </div>\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n}\r\n",
      "type": "registry:component",
      "target": "components/billingsdk/billing-settings-2.tsx"
    },
    {
      "path": "src/registry/billingsdk/demo/billing-settings-2-demo.tsx",
      "content": "\"use client\";\r\n\r\nimport { BillingSettings2 } from \"@/components/billingsdk/billing-settings-2\";\r\nimport { useState } from \"react\";\r\n\r\nexport function BillingSettings2Demo() {\r\n  const [inputValues, setInputValues] = useState({\r\n    fullName: \"\",\r\n    billingEmail: \"\",\r\n    taxId: \"\",\r\n  });\r\n\r\n  const [featureToggles, setFeatureToggles] = useState({\r\n    autoRenewal: true,\r\n    invoiceEmails: true,\r\n    promotionalEmails: false,\r\n  });\r\n\r\n  const [selectedCurrency, setSelectedCurrency] = useState(\"usd\");\r\n\r\n  const handleInputChange = (field: string, value: string) => {\r\n    setInputValues((prev) => ({\r\n      ...prev,\r\n      [field]: value,\r\n    }));\r\n  };\r\n\r\n  // Handler wrappers\r\n  const createInputChangeHandler = (field: string) => (value: string) => {\r\n    handleInputChange(field, value);\r\n  };\r\n\r\n  const createCurrencyChangeHandler =\r\n    (setCurrency: (value: string) => void) => (value: string) => {\r\n      console.log(\"Currency changed to:\", value);\r\n      setCurrency(value);\r\n      // Add: updatePricing(value), savePreference(value), etc.\r\n    };\r\n\r\n  const handleFeatureToggle = (feature: string, enabled: boolean) => {\r\n    setFeatureToggles((prev) => ({\r\n      ...prev,\r\n      [feature]: enabled,\r\n    }));\r\n  };\r\n\r\n  const handleSave = () => {\r\n    // Validation passed if we reach here\r\n    alert(\"Settings saved successfully!\");\r\n    console.log(\"Input values:\", inputValues);\r\n    console.log(\"Feature toggles:\", featureToggles);\r\n    console.log(\"Selected currency:\", selectedCurrency);\r\n  };\r\n\r\n  const handleCancel = () => {\r\n    alert(\"Changes cancelled!\");\r\n  };\r\n\r\n  return (\r\n    <div className=\"p-6\">\r\n      <BillingSettings2\r\n        title=\"Custom Billing Settings\"\r\n        inputFields={[\r\n          {\r\n            id: \"fullName\",\r\n            name: \"fullName\",\r\n            value: inputValues.fullName,\r\n            placeholder: \"Enter your full name\",\r\n            onChange: createInputChangeHandler(\"fullName\"),\r\n            label: \"Full Name\",\r\n            type: \"text\",\r\n            required: true,\r\n            validation: {\r\n              minLength: 2,\r\n              maxLength: 50,\r\n            },\r\n          },\r\n          {\r\n            id: \"billingEmail\",\r\n            name: \"billingEmail\",\r\n            value: inputValues.billingEmail,\r\n            placeholder: \"user@example.com\",\r\n            onChange: createInputChangeHandler(\"billingEmail\"),\r\n            label: \"Billing Email\",\r\n            helperText: \"Invoices will be sent to this email address\",\r\n            type: \"email\",\r\n            required: true,\r\n          },\r\n          {\r\n            id: \"taxId\",\r\n            name: \"taxId\",\r\n            value: inputValues.taxId,\r\n            placeholder: \"EU123456789\",\r\n            onChange: createInputChangeHandler(\"taxId\"),\r\n            label: \"Tax ID (Optional)\",\r\n            helperText: \"For VAT or other tax purposes\",\r\n            type: \"text\",\r\n            validation: {\r\n              pattern: /^[A-Z]{2}\\d{8,12}$/,\r\n              customValidator: (value: string) => {\r\n                if (value && !/^[A-Z]{2}\\d{8,12}$/.test(value)) {\r\n                  return \"Tax ID should be in format: XX followed by 8-12 digits (e.g., EU123456789)\";\r\n                }\r\n                return null;\r\n              },\r\n            },\r\n          },\r\n        ]}\r\n        features={[\r\n          {\r\n            id: \"auto-renewal\",\r\n            label: \"Auto-Renewal\",\r\n            description: \"Automatically renew your subscription\",\r\n            enabled: featureToggles.autoRenewal,\r\n            onToggle: (enabled) => handleFeatureToggle(\"autoRenewal\", enabled),\r\n          },\r\n          {\r\n            id: \"invoice-emails\",\r\n            label: \"Invoice Emails\",\r\n            description: \"Receive emails when invoices are generated\",\r\n            enabled: featureToggles.invoiceEmails,\r\n            onToggle: (enabled) =>\r\n              handleFeatureToggle(\"invoiceEmails\", enabled),\r\n          },\r\n          {\r\n            id: \"promotional-emails\",\r\n            label: \"Promotional Emails\",\r\n            description:\r\n              \"Receive occasional updates about new features and offers\",\r\n            enabled: featureToggles.promotionalEmails,\r\n            onToggle: (enabled) =>\r\n              handleFeatureToggle(\"promotionalEmails\", enabled),\r\n          },\r\n        ]}\r\n        // CURRENCY: Shows all 180+ currencies by default\r\n        // currencies={['USD', 'EUR', 'GBP']} // Specific currencies\r\n        // currencyOptions={[{value: 'btc', label: 'Bitcoin'}]} // Custom\r\n\r\n        defaultCurrency={selectedCurrency}\r\n        onCurrencyChange={createCurrencyChangeHandler(setSelectedCurrency)}\r\n        onSave={handleSave}\r\n        onCancel={handleCancel}\r\n        saveButtonText=\"Save Preferences\"\r\n        cancelButtonText=\"Discard Changes\"\r\n      />\r\n\r\n      {/* \r\n\t\t\tUSAGE EXAMPLES:\r\n\t\t\t- Specific: currencies={['USD', 'EUR']}\r\n\t\t\t- Custom: currencyOptions={[{value: 'btc', label: 'Bitcoin'}]}\r\n\t\t\t- All: (no currency props) = 180+ currencies\r\n\t\t\t- Handler: onCurrencyChange={(c) => updatePricing(c)}\r\n\t\t\t*/}\r\n    </div>\r\n  );\r\n}\r\n",
      "type": "registry:component",
      "target": "components/billing-settings-2-demo.tsx"
    }
  ]
}